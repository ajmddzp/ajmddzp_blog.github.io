{
    "id": "2601.07434v1",
    "title": "LOONG: Online Time-Optimal Autonomous Flight for MAVs in Cluttered Environments",
    "authors": [
        "Xin Guan",
        "Fangguo Zhao",
        "Qianyi Wang",
        "Chengcheng Zhao",
        "Jiming Chen",
        "Shuo Li"
    ],
    "abstract": "åœ¨æœªçŸ¥ã€æ‚ä¹±ç¯å¢ƒä¸­ï¼Œå¾®å‹é£è¡Œå™¨ï¼ˆMAVï¼‰çš„è‡ªä¸»é£è¡Œå› ä¿å®ˆçš„æœºåŠ¨ç­–ç•¥ï¼Œå¯¹æ—¶é—´å…³é”®å‹ä»»åŠ¡ä»å…·æŒ‘æˆ˜æ€§ã€‚æœ¬æ–‡æå‡ºä¸€ç§é›†æˆè§„åˆ’ä¸æ§åˆ¶æ¡†æ¶ï¼Œç”¨äºMAVåœ¨æ‚ä¹±ç¯å¢ƒä¸­çš„é«˜é€Ÿã€æ—¶é—´æœ€ä¼˜è‡ªä¸»é£è¡Œã€‚åœ¨æ¯ä¸ªé‡è§„åˆ’å‘¨æœŸï¼ˆ100èµ«å…¹ï¼‰ä¸­ï¼Œç”Ÿæˆå¤šé¡¹å¼è¡¨ç¤ºä¸‹çš„æ—¶é—´æœ€ä¼˜è½¨è¿¹ä½œä¸ºå‚è€ƒï¼Œå¹¶é€šè¿‡æ¨¡ä»¿å­¦ä¹ åŠ é€Ÿæ—¶é—´åˆ†é…è¿‡ç¨‹ã€‚éšåï¼Œé‡‡ç”¨æ—¶é—´æœ€ä¼˜æ¨¡å‹é¢„æµ‹è½®å»“æ§åˆ¶ï¼ˆMPCCï¼‰ï¼Œåœ¨å¯å˜é¢„æµ‹æ­¥é•¿ä¸­èå…¥å®‰å…¨é£è¡Œèµ°å»Šï¼ˆSFCï¼‰çº¦æŸï¼Œä»¥å®ç°æ¿€è¿›ä¸”å®‰å…¨çš„æœºåŠ¨ï¼ŒåŒæ—¶å……åˆ†å‘æŒ¥MAVçš„åŠ¨æ€æ€§èƒ½ã€‚æˆ‘ä»¬åœ¨å®šåˆ¶çš„åŸºäºæ¿€å…‰é›·è¾¾çš„MAVå¹³å°ä¸Šå¹¿æ³›éªŒè¯äº†æ‰€ææ¡†æ¶ã€‚ä»¿çœŸç»“æœè¡¨æ˜ï¼Œç›¸è¾ƒäºç°æœ‰æŠ€æœ¯ï¼Œè¯¥æ¡†æ¶å±•ç°å‡ºæ›´å¼ºçš„æ¿€è¿›æ€§ï¼›å®é™…é£è¡Œå®éªŒåœ¨æ‚ä¹±ç¯å¢ƒä¸­è¾¾åˆ°äº†18ç±³/ç§’çš„å³°å€¼é€Ÿåº¦ï¼Œå¹¶ä»ä¸åŒèµ·ç‚¹è¿ç»­10æ¬¡æˆåŠŸå®Œæˆé£è¡Œã€‚ç›¸å…³è§†é¢‘å¯é€šè¿‡ä»¥ä¸‹é“¾æ¥è§‚çœ‹ï¼šhttps://youtu.be/vexXXhv99oQã€‚",
    "url": "https://arxiv.org/abs/2601.07434v1",
    "html_url": "https://arxiv.org/html/2601.07434v1",
    "html_content": "LOONG: Online Time-Optimal Autonomous Flight for MAVs in Cluttered Environments\nXin Guan, Fangguo Zhao,\nQianyi Wang,\nChengcheng Zhao,\nJiming Chen,\nFellow, IEEE\n,\nand Shuo Li,\nThe authors are with the College of Control Science and Engineering, Zhejiang University, Hangzhou 310027, China (e-mail: shuo.li@zju.edu.cn)\n(Corresponding author: Shuo Li.)\n.\nAbstract\nAutonomous flight of micro air vehicles (MAVs) in unknown, cluttered environments remains challenging for time-critical missions due to conservative maneuvering strategies. This article presents an integrated planning and control framework for high-speed, time-optimal autonomous flight of MAVs in cluttered environments. In each replanning cycle (100â€‰Hz), a time-optimal trajectory under polynomial presentation is generated as a reference, with the time-allocation process accelerated by imitation learning. Subsequently, a time-optimal model predictive contouring control (MPCC) incorporates safe flight corridor (SFC) constraints at variable horizon steps to enable aggressive yet safe maneuvering, while fully exploiting the MAVâ€™s dynamics. We validate the proposed framework extensively on a custom-built LiDAR-based MAV platform. Simulation results demonstrate superior aggressiveness compared to the state of the art, while real-world experiments achieve a peak speed of 18â€‰m/s in a cluttered environment and succeed in 10 consecutive trials from diverse start points. The video is available at the following link: https://youtu.be/vexXXhv99oQ.\nI\nIntroduction\nAutonomous navigation techniques\n[\n34\n]\n,\n[\n8\n]\nfor micro air vehicles (MAVs) leverage onboard sensing and computation to perceive the unknown environment and plan collision-free trajectories.\nThese capabilities have rendered autonomous MAVs\nincreasingly indispensable in diverse applications, including\naerial photography\nand industrial inspection\n[\n9\n]\n.\nTheir importance is further amplified in time-critical missions such as search and rescue\n[\n15\n]\nand disaster relief\n[\n1\n]\n, where timely and safe arrival\nis crucial.\nIn parallel with these practical demands, autonomous MAVs have continuously broken speed records in recent years, driven by the emergence of autonomous drone\nracing\n[\n17\n]\n,\n[\n5\n]\n.\nThis competitive platform, with its emphasis on time-optimal performance, has become a benchmark for evaluating agile trajectory generation and robust control strategies under extremely high-speed conditions.\nDespite such progress, achieving time-optimal high-speed flight in real time, particularly in unknown environments, remains a formidable challenge. Specifically, the limited onboard resources of MAVs demand\nefficient system architectures and algorithms\ncapable of handling complex dynamics models, unexpected disturbances and safety constraints in real time.\nFigure 1\n:\n(a) High-speed autonomous flight trajectory of our method in the real world and point-cloud map visualization.\n(b) The corresponding throttle and velocity profiles.\nThe MAV completes a 20â€‰m flight in 2.1â€‰s and reaches a peak speed of 18.1â€‰m/s in 1.2â€‰s.\nSide and forward views both reveal that the MAV attains an aggressive pitch angle of approximately\n75\nâˆ˜\n75^{\\circ}\nduring acceleration and deceleration.\nSeveral works have focused on achieving online autonomous flight for MAV systems in unknown and cluttered environments.\nIn early efforts, Richter et al.\n[\n22\n]\nachieve aggressive flights in known environments by optimizing polynomial trajectories based on differential flatness\n[\n14\n,\n2\n]\nof the quadrotor to improve\nsystematic\nefficiency.\nFor real-time collision avoidance in unknown environments, a complete MAV system\n[\n18\n]\nis introduced based on a local polynomial trajectory planner.\nIn\n[\n16\n]\n, a MAV navigates through cluttered environments in a receding-horizon fashion, where only a local map is maintained for the local planner.\nIn this fashion, an adequate replanning frequency is required, since high computation delays severely limit both flight speed and success rate\n[\n21\n]\n.\nTo enable efficient replanning,\nFast-Planner\n[\n32\n]\nemploys B-spline for path-guided optimization, while EGO-Planner-v2\n[\n33\n]\nleverages control effort minimizer (MINCO)\n[\n28\n]\nfor spatial-temporal optimization.\nHowever, the aforementioned methods cannot systematically enable high-speed flight.\nOne reason for such low-speed flight is that visual perception can not provide a sufficiently long detection range (typically below 5â€‰m) and reaction time for avoiding obstacles at high speeds. A straightforward solution is to employ LiDAR sensors, which deliver a sufficiently wide sensing range.\nFor instance, Ren et al.\n[\n20\n]\nadopt a LiDAR-based receding horizon planning to enable high-speed flight in the wild.\nMore recently, the state-of-the-art method SUPER\n[\n21\n]\ndemonstrates LiDAR-based safety-assured high-speed navigation in unknown environments using two-trajectory planning,\nwith trajectory tracking by on-manifold MPC\n[\n13\n]\n.\nEven so, these methods do not address the other reason for conservative flight, namely that the separation of planning and control into a multi-stage pipeline increases system latency.\nTo address this, integrated planning and control (IPC) methods employ model predictive control (MPC) with a point-mass model\n[\n11\n]\nor collective-thrust-input model\n[\n30\n]\nfor agile obstacle avoidance.\nAnother class of approaches is end-to-end learning frameworks, which inherently\nadopt an integrated pipeline.\nLoquercio et al.\n[\n12\n]\napply imitation learning to enable high-speed flight in the wild\nwith inputs of depth images and partial states.\nZhang et al.\n[\n31\n]\nexploit a differentiable physics engine with a point-mass model\nand depth rendering to learn agile flight across diverse scenarios.\nNevertheless,\na substantial gap remains compared with time-optimal flights.\nFirst,\nwhen constraints exist, optimal solutions cannot in general be represented by polynomial splines\n[\n28\n]\n, as used in most optimization-based frameworks.\nSecond,\nmismatches between state-level constraints (on velocity/acceleration) used in the above frameworks and actual input constraints in real systems can cause tracking failure or excessive conservatism.\nFinally,\nall of the aforementioned frameworks rely on simplified dynamics rather than full dynamics, and employ conservative time allocations to satisfy real-time computational limits onboard MAVs.\nIn terms of time-optimal planning and control,\nseveral studies of drone racing have focused on minimizing flight time by fully exploiting the system dynamics, including the low-level actuator inputs (e.g., single-motor thrust),\nunder the given MAV platform and maximum thrust-to-weight ratio (TWR).\nRemarkably,\nFoehn et al. optimize global trajectories through waypoints using a complementary progress constraint to achieve time-optimal planning\n[\n3\n]\n.\nHowever, such methods are computationally expensive and unsuitable for online replanning.\nTo address this issue, reinforcement learning (RL)\nand model predictive contouring control (MPCC)\nhave been introduced.\nSong et al. use an RL controller to reach a peak speed of 30 m/s with a maximum TWR of 12, with external computation and sensing\n[\n25\n]\n.\nKaufmann et al. similarly fly the MAV at its physical limits, using the onboard camera\n[\n6\n]\n.\nThese RL methods can learn agile flight policies, yet often suffer from limited generalization to unseen scenarios\nand require offline training.\nTime-optimal MPCC provides an integrated planning-control framework that optimizes progress along a reference path while effectively handling\ndynamics and disturbances, achieving a peak speed over 16â€‰m/s with a maximum TWR of 3.3\n[\n24\n]\n.\nRomero et al. propose a sample-based method to generate a point-mass model reference for MPCC\n[\n23\n]\n.\nNevertheless,\nall these works assume a known environment\n(e.g., a racing track).\nTherefore,\ntheir integration into autonomous navigation systems and generalization to safely traverse unknown environments, especially under limited onboard resources, remain unclear.\nTo handle obstacle avoidance, the distance and gradient information to obstacles, derived from Euclidean signed distance field (ESDF)\n[\n19\n]\nor from projected gradient information\n[\n33\n]\n, are commonly integrated into gradient-based trajectory optimization as penalty terms.\nHowever, such gradient-based methods struggle to guarantee safety in high-speed flight, since they do not provide explicit safety boundaries for optimization.\nWhen obstacles are suddenly detected during high-speed flight,\nsoft penalties may cause the trajectory optimization to violate constraints, potentially leading to collisions with obstacles.\nOne class of solutions for solving this problem employs control barrier function (CBF) constraints to ensure the safety of dynamic systems by defining safe sets for quadrotor states\n[\n30\n]\n.\nHowever, while CBF provides formal safety guarantees, it can be sensitive to input limits and constraint conflicts, and often requires careful tuning to ensure feasibility and practical effectiveness.\nAnother widely adopted approach abstracts obstacle-free spaces as convex polytopes\n[\n27\n]\n, also referred to as a safe flight corridor (SFC)\n[\n10\n]\n.\nThis compact, convex representation significantly simplifies optimization and enhances planning efficiency and reliability in cluttered environments.\nNonetheless, while the aforementioned works can realize safe obstacle avoidance across diverse scenarios, their planning-control frameworks, algorithm implementations, and system integrations\nfail to jointly achieve the time-optimal motion performance in unknown environments.\nDespite such advances,\nexisting works\ndo not concurrently satisfy the requirements of\ntime-optimal, high-speed autonomous flight with safe obstacle avoidance in unknown environments for MAVs.\nIn this paper,\nwe propose a learning-accelerated online time-optimal integrated planning and control framework (LOONG),\nwhich builds upon our previous work in drone racing\n[\n4\n]\nand is inspired by SUPER\n[\n21\n]\n.\nThe key contributions of this work are as follows:\n1)\nA time-optimal integrated planning and control framework (Fig.\n2\n) for MAVs is proposed to achieve autonomous flight in unknown, cluttered environments.\nThis framework is characterized by high-frequency replanning (100â€‰Hz).\nAt each replanning step, time-optimal polynomial reference generation is accelerated through learning-based time allocation.\nFollowing this reference, the planning and control are solved simultaneously in one optimization problem to further enhance system performance.\nFigure 2\n:\nLOONG is an integrated planning-control framework\ndesigned for time-optimal autonomous flight.\nBy leveraging odometry and a point-cloud map generated from LiDAR and IMU sensors, LOONG directly outputs angular velocity and throttle commands to the flight control unit. It comprises a computationally lightweight reference generation module as the frontend, and a high-performance optimal control module as the backend.\nOnline replanning is guided by the previous MPCC trajectory to achieve both aggressive and safe flight.\n2)\nAn efficient MPC is proposed that integrates time-optimal MPCC with SFC for MAVs integrated planning and control, especially in high-speed flight,\nleveraging the MAVâ€™s full dynamics.\nBy imposing SFC constraints at variable horizon steps,\nwe concurrently satisfy both aggressiveness and safety requirements.\nThe outputs of MPCC are directly used as actual execution commands.\n3)\nWe integrate the proposed method into a\nLiDAR-based\nfully autonomous quadrotor system\nand extensively evaluated the system in both simulation and real-world environments.\nIn simulation, our framework outperformed the state of the art for\nautonomous navigation in terms of aggressiveness while achieving obstacle avoidance.\nIn the real world, the MAV achieved\na peak speed of 18â€‰m/s in a 20â€‰m flight\nand succeeded over 10 consecutive trials from different start points.\nII\nLearning-Accelerated Online Time-Optimal Reference Trajectory Generation\nThe system\narchitecture\nbased on the proposed\nplanning and control\nframework is illustrated in Fig.\n2\n.\nIt operates upon\na point-cloud map and\ncharacterized by a learning-accelerated time-optimal trajectory generator (Section\nII\n) with a processing latency below 1â€‰ms to swiftly respond to environmental changes during high-speed flight, and a\nsafe-enhanced\ntime-optimal\nMPCC\nalgorithm (Section\nIII\n), which runs at 100â€‰Hz.\nIn time-optimal autonomous flight, efficient trajectory planning is crucial for ensuring safety at high speeds due to the limited perception range.\nThis section employs an efficient and safe front-end path planning method, along with a learning-based time-allocation approach, for reference trajectory generation. This method significantly enhances the efficiency of generating time-optimal polynomial trajectories to serve as exploratory references for MPCC, which requires a good approximation of the time-optimal policy to enhance the stability and quality of the solution.\nII-A\nPath Planning and Waypoints Generation\nThe front-end path planning aims to efficiently generate a safe global path\nincluding discrete positions or waypoints\nfor obstacle avoidance\nfrom the current position\nğ’‘\nc\n\\bm{p}_{c}\nto the goal position\nğ’‘\nd\n\\bm{p}_{d}\n, as depicted in Fig.\n3\n.\nInitially, an A* path (i, orange points) search algorithm\nis employed to find a collision-free path connecting\nğ’‘\nc\n\\bm{p}_{c}\nand\nğ’‘\nd\n\\bm{p}_{d}\n.\nTo find the shorten path (ii), the\ndiscretized\nA* path is then refined\nby iteratively finding the furthest visible point from the end of the last line segment (blue lines).\nFigure 3\n:\nPath planning and waypoints generation process involves (i) an A*-based path search, (ii) shorten and line seed generation, (iii) SFC convex decomposition (iv) and computing overlapping centers as waypoints for (v) subsequent trajectory generation.\nSince the shortened path typically lies near obstacle boundaries, inspired by\n[\n21\n]\n,\nwe want to enhance safety by keeping waypoints away from obstacles, as this improves onboard sensor visibility and enlarges the free space available for local trajectory planning. To this end, we introduce the concept of a safe flight corridor (SFC), which consists of a set of convex polytopes derived from seeds (e.g., point or line) that explicitly exclude obstacles\n[\n27\n]\n.\nThe polytope\nğ’«\n\\mathcal{P}\nis defined as the intersection of\nm\nm\nhalf-spaces:\nğ’«\n=\n{\nğ’š\nâˆˆ\nâ„\nn\nâˆ£\nğ‘¨\nâ€‹\nğ’š\nâ‰¤\nğ’ƒ\n}\n,\nğ‘¨\nâˆˆ\nâ„\nm\nÃ—\nn\n,\nğ’ƒ\nâˆˆ\nâ„\nm\n\\mathcal{P}=\\{\\bm{y}\\in\\mathbb{R}^{n}\\mid\\bm{A}\\bm{y}\\leq\\bm{b}\\},\\quad\\bm{A}\\in\\mathbb{R}^{m\\times n},\\quad\\bm{b}\\in\\mathbb{R}^{m}\n(1)\nwhere\nğ’š\n\\bm{y}\nare the states of the MAV,\nm\nm\nis the number of hyperplanes of a convex polytope,\nğ‘¨\nâˆˆ\nâ„\nm\nÃ—\nn\n\\bm{A}\\in\\mathbb{R}^{m\\times n}\nrepresenting the normal vectors of hyperplanes, and\nğ’ƒ\nâˆˆ\nâ„\nm\n\\bm{b}\\in\\mathbb{R}^{m}\nrepresenting the constants of hyperplanes.\nHere, we set\nn\n=\n3\nn=3\nto impose SFC constraints on position space.\nTherefore, as shown in Fig.\n3\n, each line segment derived from the shortened path (ii) can serve as a seed for SFC convex decomposition (iii, green polytopes).\nThen, the centers of the overlapping regions between adjacent polytopes are selected as waypoints (iv, purple points) for subsequently generating time-optimal polynomial reference trajectories (v).\nSpecifically,\nto enhance efficiency and ensure compatibility with LiDAR point clouds, we adopt the configuration-space iterative regional inflation (CIRI) algorithm\n[\n21\n]\n, which directly operates on point clouds to extract convex polytopes.\nII-B\nTime-Optimal Polynomial Trajectory Optimization\nAfter\npath planning, a sequence of next\nM\nM\nwaypoints\nğ’‘\ni\n\\bm{p}_{i}\n,\nâˆ€\ni\nâˆˆ\n{\n1\n,\nâ€¦\n,\nM\n}\n\\forall i\\in\\{1,\\dots,M\\}\nis obtained.\nTo enable high-speed flight,\nThis section focuses on generating a time-optimal reference under the finite-degree polynomial representations passing through all\nğ’‘\ni\n\\bm{p}_{i}\n.\nTypically,\nwhen considering the full quadrotor dynamics,\nthe nonlinearity\nof constraints\nmake model-based time-optimal trajectory optimization computationally demanding. By exploiting the differential flatness\n[\n14\n,\n2\n]\n,\nthe quadrotorâ€™s trajectory can be expressed through its flat outputs:\nğˆ\n=\n[\np\nx\n,\np\ny\n,\np\nz\n,\nÏˆ\n]\nT\nâˆˆ\nâ„\n3\nÃ—\nS\n1\n\\bm{\\sigma}=[p_{x},p_{y},p_{z},\\psi]^{T}\\in\\mathbb{R}^{3}\\times S^{1}\n,\nwhere\nğ’‘\n=\n[\np\nx\n,\np\ny\n,\np\nz\n]\nT\nâˆˆ\nâ„\n3\n\\bm{p}=[p_{x},p_{y},p_{z}]^{T}\\in\\mathbb{R}^{3}\ndenotes the position, and\nÏˆ\nâˆˆ\nS\n1\n\\psi\\in S^{1}\nindicates the yaw angle.\nAs such,\nconstraints can be applied discretely to the linear combination of the 0-th to\ns\ns\n-th order derivatives of\nğˆ\n\\bm{\\sigma}\n. To extract state information at any\ntimestamp,\na common method involves parameterizing the trajectory as a\nM\nM\n-piece polynomial\nğˆ\nâ€‹\n(\nt\n)\n\\bm{\\sigma}(t)\n,\nwith each piece represented by a\nN\n=\n2\nâ€‹\ns\nâˆ’\n1\nN=2s-1\ndegree polynomial\nğˆ\ni\nâ€‹\n(\nt\n)\n=\nğœ\ni\nâŠ¤\nâ€‹\nğœ·\nâ€‹\n(\nt\nâˆ’\nt\ni\nâˆ’\n1\n)\n,\nt\nâˆˆ\n[\nt\ni\nâˆ’\n1\n,\nt\ni\n]\n,\n\\bm{\\sigma}_{i}(t)=\\mathbf{c}_{i}^{\\top}\\bm{\\beta}(t-t_{i-1}),t\\in[t_{i-1},t_{i}],\nwhere\nğœ·\nâ€‹\n(\nt\n)\n=\n[\n1\n,\nt\n,\nt\n2\n,\nâ€¦\n,\nt\nN\n]\nâŠ¤\n\\bm{\\beta}(t)=[1,t,t^{2},\\dots,t^{N}]^{\\top}\n.\nThe polynomial trajectory\nğˆ\nâ€‹\n(\nt\n)\n\\bm{\\sigma}(t)\nis encoded through its coefficient matrix\nğœ\n\\mathbf{c}\nand time allocation intervals\nğ“\n\\mathbf{T}\n:\nğœ\n\\displaystyle\\mathbf{c}\n=\n[\nğœ\n1\nâŠ¤\n,\nâ€¦\n,\nğœ\nM\nâŠ¤\n]\nâŠ¤\nâˆˆ\nâ„\n2\nâ€‹\nM\nâ€‹\ns\nÃ—\n4\n\\displaystyle=[\\mathbf{c}_{1}^{\\top},\\dots,\\mathbf{c}_{M}^{\\top}]^{\\top}\\in\\mathbb{R}^{2Ms\\times 4}\n(2)\nğ“\n\\displaystyle\\mathbf{T}\n=\n[\nT\n1\n,\nâ€¦\n,\nT\nM\n]\nâŠ¤\nâˆˆ\nâ„\n>\n0\nM\n\\displaystyle=[T_{1},\\dots,T_{M}]^{\\top}\\in\\mathbb{R}^{M}_{>0}\nwhere\nT\ni\nT_{i}\nrepresents the duration of the\ni\ni\n-th segment. The timestamp for each waypoint is given by\nt\ni\n=\nâˆ‘\nj\n=\n1\ni\nT\nj\nt_{i}=\\sum_{j=1}^{i}T_{j}\nand the total duration of the trajectory is\nT\n=\nâ€–\nğ“\nâ€–\n1\nT=\\|\\mathbf{T}\\|_{1}\n.\nUsing the minimal-control polynomial trajectory\n[\n28\n]\n,\nthe\ncoefficient matrix is given by:\nM(T)\nâ€‹\nğœ\n=\nğ›\n\\textbf{M(T)}\\mathbf{c}=\\mathbf{b}\n(3)\nwhere\nM\nâˆˆ\nâ„\n2\nâ€‹\nM\nâ€‹\ns\nÃ—\n2\nâ€‹\nM\nâ€‹\ns\n\\textbf{M}\\in\\mathbb{R}^{2Ms\\times 2Ms}\nis a nonsingular banded matrix determined solely by the time allocation\nğ“\n\\mathbf{T}\n, and\nğ›\nâˆˆ\nâ„\n2\nâ€‹\nM\nâ€‹\ns\nÃ—\n4\n\\mathbf{b}\\in\\mathbb{R}^{2Ms\\times 4}\ncontains the specified derivatives (i.e., the positions and their respective derivatives) at the boundaries of\nğˆ\ni\nâ€‹\n(\nt\n)\n\\bm{\\sigma}_{i}(t)\n.\nThe unique solution\nğœ\n\\mathbf{c}\ncan be obtained by solving\n(\n3\n)\ngiven\nğ“\n\\mathbf{T}\n.\nWithin the polynomial representation, the time-optimal trajectory generation problem\nis defined as:\nmin\nğ“\n\\displaystyle\\!\\!\\!\\min_{\\mathbf{T}}\\quad\nT\n,\n\\displaystyle T,\n(4)\ns.t.\nâ„±\nâ€‹\n(\nğˆ\nâ€‹\n(\nt\n)\n,\nâ€¦\n,\nğˆ\n(\ns\n)\nâ€‹\n(\nt\n)\n)\nâª¯\n0\n,\nâˆ€\nt\nâˆˆ\n[\n0\n,\nT\n]\n,\n\\displaystyle\\mathcal{F}(\\bm{\\sigma}(t),\\ldots,\\bm{\\sigma}^{(s)}(t))\\preceq 0,\\quad\\forall t\\in[0,T],\nğˆ\n[\ns\nâˆ’\n1\n]\nâ€‹\n(\n0\n)\n=\nğˆ\no\n,\nğˆ\n[\ns\nâˆ’\n1\n]\nâ€‹\n(\nT\n)\n=\nğˆ\nf\n,\n\\displaystyle\\bm{\\sigma}^{[s-1]}(0)={\\bm{\\sigma}}_{o},\\quad\\bm{\\sigma}^{[s-1]}(T)={\\bm{\\sigma}}_{f},\nğˆ\nâ€‹\n(\nt\ni\n)\n=\nğˆ\ni\n,\n1\nâ‰¤\ni\nâ‰¤\nM\nâˆ’\n1\n\\displaystyle\\bm{\\sigma}(t_{i})={\\bm{\\sigma}}_{i},\\quad 1\\leq i\\leq M-1\nwhere\nğˆ\no\nâˆˆ\nâ„\n4\nÃ—\ns\n{\\bm{\\sigma}}_{o}\\in\\mathbb{R}^{4\\times s}\ndenotes the initial state, and\nğˆ\nf\nâˆˆ\nâ„\n4\nÃ—\ns\n{\\bm{\\sigma}}_{f}\\in\\mathbb{R}^{4\\times s}\nrepresents the final state.\nğˆ\ni\n{\\bm{\\sigma}}_{i}\nrepresents the combination of\nğ’‘\ni\n\\bm{p}_{i}\nand a fixed yaw angle, and\nâ„±\n\\mathcal{F}\nrepresents the dynamically feasible constraints imposed on the system.\nIn this paper,\nwe represent the trajectory using 5-degree minimum-jerk polynomials, with\ns\n=\n3\ns=3\nto satisfy the collective thrust and bodyrates constraints.\nThe optimization problem (\n4\n) can be solved in two layers, with the outer layer optimizing the duration\nT\ni\nT_{i}\nand the inner layer solving (\n3\n) for a given\nT\ni\nT_{i}\nto compute the coefficients\nğœ\ni\n\\mathbf{c}_{i}\nof each polynomial segment.\nHowever, the outer\nlayer optimization\nproblem is non-convex, and solving it with\nnonlinear\nconstraints\nto find feasible solutions\ncan be computationally intensive.\nFurthermore, the quality and success rate of the optimization are sensitive to the initial guess of\nğ“\n\\mathbf{T}\n, which makes it difficult to stably generate valid trajectories.\nTherefore, a stable and efficient method is required to optimize time allocation and generate references for MPCC during high-frequency planning in flight.\nII-C\nAccelerating Time Allocation by Imitation Learning\nAs stated above,\nthe main challenge in generating a time-optimal\ntrajectory\nlies in solving the computationally intensive minimum-time problem (\n4\n), primarily due to the complexity of time allocation and the sensitivity to initial conditions. Fortunately, once the optimal time allocation\nğ“\nâˆ—\n\\mathbf{T}^{*}\nis provided,\nthe polynomial trajectory can be generated by solving (\n3\n) with linear complexity, requiring minimal computational resources.\nFigure 4\n:\nNeural network inferences time allocation from current states and waypoints to efficiently generate a multi-piece polynomial as reference trajectory.\nTo accelerate the time allocation process in real time, we utilize a lightweight neural network that mimics the time allocation of expert trajectories, as shown in Fig.\n4\n. The network consists of a multi-layer perceptron (MLP) with two hidden layers, each containing 512 neurons.\nThe MLPâ€™s input is a one-dimensional vector comprising the MAVâ€™s current velocity\nğ’—\nâˆˆ\nâ„\n3\n\\bm{v}\\in\\mathbb{R}^{3}\nand acceleration\nğ’‚\nâˆˆ\nâ„\n3\n\\bm{a}\\in\\mathbb{R}^{3}\n, along with the relative positions to the next\nM\nM\nwaypoints\nÎ”\nâ€‹\nğ’‘\nâˆˆ\nâ„\n3\nÃ—\nM\n\\Delta\\bm{p}\\in\\mathbb{R}^{3\\times M}\n.\nThe output is the sequence of optimal time allocations\nğ“\nâˆ—\nâˆˆ\nâ„\nM\n\\mathbf{T}^{*}\\in\\mathbb{R}^{M}\n.\nNote that during flight in unstructured environments, the number of waypoints obtained by the front-end path planner may vary.\nTo address this, we set a sufficiently large\nM\nM\nto maintain the neural network architecture and pad the input and output with placeholder values to preserve the expected dimensions.\nSubsequently, the\nvector\nğ“\nâˆ—\n\\mathbf{T}^{*}\nis utilized\nalongside\nğ’‘\ni\n\\bm{p}_{i}\nto solve\n(\n3\n), yielding the polynomial coefficients\nğœ\n\\mathbf{c}\nand thus the optimal polynomial trajectory.\nFor dataset generation,\nWe use MINCO\n[\n28\n]\nto connect the current states and the sampled relative waypoints\nğ’‘\ni\n\\bm{p}_{i}\nvia minimum-control polynomials. The waypoints\nğ’‘\ni\n\\bm{p}_{i}\nand their corresponding durations\nT\ni\nT_{i}\nare extracted to form the dataset used to train the neural networks.\nReaders are referred to our previous work\n[\n4\n]\nfor details of the time-allocation network\napplied to\ntime-optimal planning.\nIn summary,\nthis method can generate a dynamically feasible and near time-optimal trajectory in real time under polynomial representations.\nHowever, polynomial trajectory optimization is a relaxation of the time-optimal control problem for MAVs navigating through multiple waypoints, which inevitably leaves a non-negligible gap compared to true time-optimal navigation.\nThis\ngap\nstems primarily from the inherent smoothness of finite-degree polynomials, which cannot fully exploit\ncontrol inputs\n[\n3\n]\n.\nIII\nTime-Optimal Model Predictive Contouring Control with Collision Avoidance\nThis section presents a control method, referred to as MPCC, that tracks the reference trajectory in a truly time-optimal manner while accounting for the full quadrotor dynamics and obstacle avoidance.\nIII-A\nQuadrotor Dynamics\nThe quadrotorâ€™s state space is expressed as\nğ’™\n=\n[\nğ’‘\n,\nğ’’\n,\nğ’—\n,\nğ\n]\nT\n\\bm{x}=\\begin{bmatrix}\\bm{p},\\bm{q},\\bm{v},\\bm{\\omega}\\end{bmatrix}^{T}\n,\nwhere\nğ’‘\nâˆˆ\nâ„\n3\n\\bm{p}\\in\\mathbb{R}^{3}\nrepresents the position,\nğ’’\nâˆˆ\nğ•Š\nâ€‹\nğ•†\nâ€‹\n(\n3\n)\n\\bm{q}\\in\\mathbb{SO}(3)\ndenotes the attitude quaternion,\nğ’—\nâˆˆ\nâ„\n3\n\\bm{v}\\in\\mathbb{R}^{3}\nis the linear velocity, and\nğ\nâˆˆ\nâ„\n3\n\\bm{\\omega}\\in\\mathbb{R}^{3}\nrepresents the bodyrates in the body frame.\nThe system inputs include the collective thrust\nğ‘­\n\\bm{F}\nand body torques\nğ‰\n\\bm{\\tau}\n.\nThe dynamic equations\nare expressed as:\nğ’‘\nË™\n\\displaystyle\\dot{\\bm{p}}\n=\nğ’—\n,\n\\displaystyle=\\bm{v},\n(5)\nğ’’\nË™\n\\displaystyle\\dot{\\bm{q}}\n=\n1\n2\nâ€‹\nğ’’\nâŠ™\n[\n0\nğ\n]\n,\n\\displaystyle=\\frac{1}{2}\\bm{q}\\odot\\begin{bmatrix}0\\\\\n\\bm{\\omega}\\end{bmatrix},\nğ’—\nË™\n\\displaystyle\\dot{\\bm{v}}\n=\nğ’ˆ\n+\n1\nm\nâ€‹\nğ‘\nâ€‹\n(\nq\n)\nâ€‹\nğ‘­\nâˆ’\nğ‘\nâ€‹\n(\nğ’’\n)\nâ€‹\nğ‘«\nâ€‹\nğ‘\nT\nâ€‹\n(\nğ’’\n)\nâ‹…\nğ’—\n,\n\\displaystyle=\\bm{g}+\\frac{1}{m}\\mathbf{R}(q)\\bm{F}-\\mathbf{R}(\\bm{q})\\bm{D}\\mathbf{R}^{T}(\\bm{q})\\cdot\\bm{v},\nğ\nË™\n\\displaystyle\\dot{\\bm{\\omega}}\n=\nğ‰\nâˆ’\n1\nâ€‹\n(\nğ‰\nâˆ’\nğ\nÃ—\nğ‰\nâ€‹\nğ\n)\n\\displaystyle=\\mathbf{J}^{-1}\\left(\\bm{\\tau}-\\bm{\\omega}\\times\\mathbf{J}\\bm{\\omega}\\right)\nwhere\nâŠ™\n\\odot\nrepresents Hamilton quaternion multiplication,\nğ‘\nâ€‹\n(\nğ’’\n)\n\\mathbf{R}(\\bm{q})\nis the quaternion rotation matrix,\nm\nm\nis the quadrotor mass,\nğ‰\n\\mathbf{J}\nis the inertia matrix, and\nğ‘«\n=\ndiag\nâ€‹\n(\nd\nx\n,\nd\ny\n,\nd\nz\n)\n\\bm{D}=\\text{diag}(d_{x},d_{y},d_{z})\nrepresents the drag coefficients\n[\n2\n]\n.\nAdditionally, the input of\nğ‘­\n\\bm{F}\nand\nğ‰\n\\bm{\\tau}\nis decomposed into individual rotor thrusts\nğ’‡\n=\n[\nf\n1\n,\nf\n2\n,\nf\n3\n,\nf\n4\n]\n\\bm{f}=[f_{1},f_{2},f_{3},f_{4}]\n:\nğ‘­\n=\n[\n0\n0\nâˆ‘\nf\ni\n]\n,\nand\nğ‰\n=\n[\nl\n2\nâ€‹\n(\nf\n1\n+\nf\n2\nâˆ’\nf\n3\nâˆ’\nf\n4\n)\nl\n2\nâ€‹\n(\nâˆ’\nf\n1\n+\nf\n2\n+\nf\n3\nâˆ’\nf\n4\n)\nc\nÏ„\nâ€‹\n(\nf\n1\nâˆ’\nf\n2\n+\nf\n3\nâˆ’\nf\n4\n)\n]\n\\bm{F}=\\begin{bmatrix}0\\\\\n0\\\\\n\\sum f_{i}\\end{bmatrix},\\quad\\text{and}\\quad\\bm{\\tau}=\\begin{bmatrix}\\frac{l}{\\sqrt{2}}(f_{1}+f_{2}-f_{3}-f_{4})\\\\\n\\frac{l}{\\sqrt{2}}(-f_{1}+f_{2}+f_{3}-f_{4})\\\\\nc_{\\tau}(f_{1}-f_{2}+f_{3}-f_{4})\\end{bmatrix}\n(6)\nwhere\nf\ni\nf_{i}\nis the thrust at rotor\ni\nâˆˆ\n{\n1\n,\n2\n,\n3\n,\n4\n}\ni\\in\\{1,2,3,4\\}\n,\nl\nl\nrepresents the quadrotorâ€™s arm length and\nc\nÏ„\nc_{\\tau}\nis the rotorâ€™s torque constant.\nIII-B\nTime-Optimal MPCC Integrating with SFC\nIn contrast to solving trajectory planning and control separately, model predictive contouring control (MPCC)\nallows robust tracking of a continuously differentiable path while maximizing\nthe traverse speed\nin a receding horizon fashion by solving the time allocation and control problems simultaneously in real time\n[\n24\n]\n.\nIn time-critical scenarios, a time-optimal reference path (e.g., time-optimal point-mass model trajectory or time-optimal polynomial trajectory\n[\n4\n]\n) helps the MPCC find a good approximation of the time-optimal policy.\nFor the MPCC, deviations from the reference path are permitted to enhance aggressiveness.\nNevertheless,\nin cluttered environments,\nsacrificing tracking accuracy\nfor time-optimal performance\ncan result in unsafe flight trajectories.\nThus, to ensure safety, this section proposes a\nvariant MPCC\nto constrain a certain horizon of the predicted trajectory\nwithin the known free space based on SFC,\nenabling agile obstacle avoidance\nat a high replanning frequency,\nas shown in Fig.\n5\n.\nThe contouring control problem transforms the trajectory to be tracked, parameterized by time, into an arc-length parameterized trajectory.\nThe arc length of the reference path (or progress) is denoted as\nÎ¸\n\\theta\n, with the arc length at timestep\nk\nk\ndenoted as\nÎ¸\nk\n\\theta_{k}\n.\nTo incorporate the dynamics (\n5\n) within the MPCC formulation, the state space is augmented with progress dynamics by adding\nÎ¸\n\\theta\nand progress speed\nv\nÎ¸\nv_{\\theta}\nas virtual states:\nğ’™\nÂ¯\n=\n[\nğ’‘\n,\nğ’’\n,\nğ’—\n,\nğ’˜\n,\nğ’‡\n,\nÎ¸\n,\nv\nÎ¸\n]\nT\n,\nğ’–\nÂ¯\n=\n[\nÎ”\nâ€‹\nğ’‡\n,\nÎ”\nâ€‹\nv\nÎ¸\n]\nT\n\\bm{\\bar{x}}=[\\bm{p},\\bm{q},\\bm{v},\\bm{w},\\bm{f},\\theta,v_{\\theta}]^{T},\\quad\\bm{\\bar{u}}=[\\Delta\\bm{f},\\Delta v_{\\theta}]^{T}\n(7)\nwhere the progress acceleration\nÎ”\nâ€‹\nv\nÎ¸\n\\Delta v_{\\theta}\nis introduced as a virtual input, following typical contouring controller implementations\n[\n24\n]\n,\nto avoid uncontrolled rapid change of\nv\nÎ¸\nv_{\\theta}\n, which would result in noisy control inputs. The dynamics of the augmented states are:\nğ’‡\nË™\n=\nÎ”\nâ€‹\nğ’‡\n,\nÎ¸\nË™\n=\nv\nÎ¸\n,\nv\nË™\nÎ¸\n=\nÎ”\nâ€‹\nv\nÎ¸\n\\dot{\\bm{f}}=\\Delta\\bm{f},\\quad\\dot{\\theta}=v_{\\theta},\\quad\\dot{v}_{\\theta}=\\Delta v_{\\theta}\\\\\n(8)\nFigure 5\n:\n3D MPCC diagram with local SFC constraints\napplied to the first\nG\nG\nsteps\nto enable\ntime-optimal\nflight while avoiding obstacles.\nThe MPCC problem is formulated as follows :\nÏ€\nâ€‹\n(\nğ’™\n)\n=\nargmin\nğ’–\nÂ¯\n\\displaystyle\\pi(\\bm{x})=\\underset{\\bm{\\bar{u}}}{\\mathrm{argmin}}\nâˆ‘\nk\n=\n0\nN\n(\nâˆ¥\nğ’†\nl\n(\nÎ¸\nk\n)\nâˆ¥\nq\nl\n2\n+\nâˆ¥\nğ’†\nc\n(\nÎ¸\nk\n)\nâˆ¥\nq\nc\n2\n\\displaystyle\\sum_{k=0}^{N}\\big(\\|\\bm{e}^{l}(\\theta_{k})\\|^{2}_{q_{l}}+\\|\\bm{e}^{c}(\\theta_{k})\\|^{2}_{q_{c}}\n(9)\n+\nâ€–\nğ\nk\nâ€–\nQ\nÏ‰\n2\n\\displaystyle+\\|\\bm{\\omega}_{k}\\|^{2}_{{Q_{\\omega}}}\n+\nâˆ¥\nÎ”\nğ’‡\nk\nâˆ¥\nR\nÎ”\nâ€‹\nğ’‡\n2\n+\nâˆ¥\nÎ”\nv\nÎ¸\nk\nâˆ¥\nR\nÎ”\nâ€‹\nv\n2\nâˆ’\nÎ¼\nv\nÎ¸\n,\nk\n)\n\\displaystyle+\\|\\Delta\\bm{f}_{k}\\|^{2}_{{R}_{\\Delta\\bm{f}}}+\\|\\Delta v_{\\theta_{k}}\\|^{2}_{R_{\\Delta v}}-\\mu v_{\\theta,k}\\big)\nsubject to\nğ’™\n0\n=\nğ’™\nÂ¯\n\\displaystyle\\bm{x}_{0}=\\bm{\\bar{x}}\nğ’™\nÂ¯\nk\n+\n1\n=\nğ’™\nÂ¯\nk\n+\nd\nt\nâ‹…\nf\nâ€‹\n(\nğ’™\nÂ¯\nk\n,\nğ’–\nÂ¯\nk\n)\n\\displaystyle\\bm{\\bar{x}}_{k+1}=\\bm{\\bar{x}}_{k}+d_{t}\\cdot f(\\bm{\\bar{x}}_{k},\\bm{\\bar{u}}_{k})\nğ\nm\nâ€‹\ni\nâ€‹\nn\nâ‰¤\nğ\nâ‰¤\nğ\nm\nâ€‹\na\nâ€‹\nx\n\\displaystyle\\bm{\\omega}_{min}\\leq\\bm{\\omega}\\leq\\bm{\\omega}_{max}\nğ’‡\nm\nâ€‹\ni\nâ€‹\nn\nâ‰¤\nğ’‡\nâ‰¤\nğ’‡\nm\nâ€‹\na\nâ€‹\nx\n\\displaystyle\\bm{f}_{min}\\leq\\bm{f}\\leq\\bm{f}_{max}\n0\nâ‰¤\nv\nÎ¸\nâ‰¤\nv\nÎ¸\n,\nm\nâ€‹\na\nâ€‹\nx\n\\displaystyle 0\\leq v_{\\theta}\\leq{v}_{\\theta,max}\nÎ”\nâ€‹\nğ’‡\nm\nâ€‹\ni\nâ€‹\nn\nâ‰¤\nÎ”\nâ€‹\nğ’‡\nâ‰¤\nÎ”\nâ€‹\nğ’‡\nm\nâ€‹\na\nâ€‹\nx\n\\displaystyle\\Delta\\bm{f}_{min}\\leq\\Delta\\bm{f}\\leq\\Delta\\bm{f}_{max}\nÎ”\nâ€‹\nv\nÎ¸\n,\nm\nâ€‹\ni\nâ€‹\nn\nâ‰¤\nÎ”\nâ€‹\nv\nÎ¸\nâ‰¤\nÎ”\nâ€‹\nv\nÎ¸\n,\nm\nâ€‹\na\nâ€‹\nx\n\\displaystyle\\Delta v_{\\theta,min}\\leq\\Delta v_{\\theta}\\leq\\Delta v_{\\theta,max}\nwhere the contour error\nğ’†\nc\nâ€‹\n(\nÎ¸\nk\n)\n\\bm{e}^{c}(\\theta_{k})\nand lag error\nğ’†\nl\nâ€‹\n(\nÎ¸\nk\n)\n\\bm{e}^{l}(\\theta_{k})\nrepresent the perpendicular and tangential errors between the position\np\nk\np_{k}\nand its projection on the reference path\np\nd\nâ€‹\n(\nÎ¸\n)\np^{d}(\\theta)\nat timestep\nk\nk\n, as in Fig.\n5\n. The\nq\nc\nq_{c}\n,\nq\nl\nq_{l}\n, and\nÎ¼\n\\mu\nare the weights for the contour error, lag error, and progress term, respectively.\nN\nN\nrepresents the prediction horizon, and\nf\nâ€‹\n(\nğ’™\nÂ¯\nk\n,\nğ’–\nÂ¯\nk\n)\nf(\\bm{\\bar{x}}_{k},\\bm{\\bar{u}}_{k})\ndenotes the dynamics derived by discretizing (\n5\n) and (\n8\n) with time step\nd\nt\nd_{t}\n.\nAlthough the waypoints generated in Section\nII-A\nare guaranteed to be obstacle-free, the resulting polynomial reference trajectories may still collide with obstacles, since no constraints are imposed on the trajectory segments between the waypoints.\nMoreover, due to the inherent trade-off between tracking accuracy and time optimality in MPCC, the resulting trajectory may deviate from the reference even when the reference itself is collision-free, potentially leading to collisions with obstacles.\nFurthermore, (\n1\n) optimistically assumes that unseen regions are obstacle-free.\nThus,\nto ensure safety,\nthe planned trajectory of the MPCC must be rigorously constrained to remain within the known free space.\nFrom point cloud data under partial environmental knowledge,\nit is guaranteed\nthat a polytope\nğ’\n\\mathcal{C}\nextracted by CIRI remains entirely within the known free space, provided that the input point cloud forms a sufficiently dense depth image from LiDAR sensors and that the input seed includes the current MAV position\n[\n21\n]\n.\nHence, similar to (\n1\n), a local SFC\nğ’\n\\mathcal{C}\nis qualified as a strict constraint for position\nğ’‘\n\\bm{p}\nto ensure safety:\nğ’\n=\n{\nğ’‘\nâˆˆ\nâ„\n3\nâˆ£\nğ‘¨\nâ€‹\nğ’‘\nâ‰¤\nğ’ƒ\n}\n,\nğ‘¨\nâˆˆ\nâ„\nm\nÃ—\n3\n,\nğ’ƒ\nâˆˆ\nâ„\nm\n\\mathcal{C}=\\{\\bm{p}\\in\\mathbb{R}^{3}\\mid\\bm{A}\\bm{p}\\leq\\bm{b}\\},\\quad\\bm{A}\\in\\mathbb{R}^{m\\times 3},\\quad\\bm{b}\\in\\mathbb{R}^{m}\n(10)\nFor each planning cycle,\nthe naive idea is to\ndirectly incorporate the local SFC constraints\nğ’\n\\mathcal{C}\ninto the\nMPCC predicted positions over the entire future horizon\nN\nN\n.\nHowever,\nwhen unknown obstacles are detected during flight, environmental changes can cause frequent shrinking and expanding of the local SFC, which is particularly true during high-speed flight or in unstructured, dense environments.\nIf SFC constraints are applied to the entire horizon, a suddenly narrowed SFC may result in its range being smaller than the MPCCâ€™s trajectory length.\nThus, it may decrease global flight speed, leading to conservative performance.\nMoreover, as a well-known drawback of optimization-based controllers, imposing excessively tight constraints may undermine the solverâ€™s stability and success rate\n[\n7\n]\n.\nConsidering the high replanning frequency and efficient time allocation of the proposed method,\nsince MPC follows a receding-horizon scheme and applies only the first control input at each iteration, constraining the immediate state should guarantee that the quadrotors remain within the safe region.\nHowever, for real-time implementation, the MPCC employs an iterative scheme for computational efficiency,\nwhich requires multiple rolling iterations to obtain a feasible solution\n[\n26\n]\n.\nDuring runtime, constraining only the next-step state leads to suboptimal obstacle avoidance performance and may compromise safety.\nTo strike a balance between aggressiveness and safety, we define\nG\n<\nN\nG<N\nas the\nsafe\nhorizon and only impose constraints on the first\nG\nG\nsteps of the MPCC:\nğ‘¨\nâ€‹\nğ’‘\nk\nâ‰¤\nğ’ƒ\n,\nk\nâˆˆ\n{\n1\n,\nâ€¦\n,\nG\n}\n\\bm{A}\\bm{p}_{k}\\leq\\bm{b},\\quad k\\in\\{1,\\ldots,G\\}\n(11)\nwhere\nğ’‘\nk\n\\bm{p}_{k}\nis the predicted position computed by MPCC at timestep\nk\nk\n.\nBy embedding (\n11\n) into (\n9\n), aggressive yet safe flight can be achieved,\nas depicted in Fig.\n5\n.\nFor high-speed flight in partially known environments,\nthe continuously updating map necessitates high-frequency replanning for obstacle avoidance.\nHowever,\nWhen the local SFC\nğ’\n\\mathcal{C}\nand front-end path are generated,\nthe detection of previously unseen obstacles can lead to inconsistencies in path topology between consecutive planning loops, which may result in suboptimal or even unstable behavior of the MPC-based scheme.\nTo address this issue, we propose a replanning method that ensures a smooth and consistent transition between trajectories generated in consecutive planning loops, which is called the\ntrajectory reuse\nstrategy.\nAt current planning loop, the A* algorithm is initialized from\np\nG\np_{G}\n, which corresponds to the\nG\nG\n-th state of the trajectory generated in the previous planning loop, while the states between the current state\np\nc\np_{c}\nand\np\nG\np_{G}\nare guaranteed to be safe by the SFC constructed in the previous loop (Fig.\n6\n(a)). Moreover, since both\np\nc\np_{c}\nand\np\nG\np_{G}\nlie within the convex polytope of the previous SFC, which is obstacle-free by construction, they can be directly used as valid seeds for convex decomposition to generate the SFC\nğ’\n\\mathcal{C}\nfor the current planning loop (Fig.\n6\n(b)). This strategy ensures the consistency of the MPCC formulation across consecutive planning loops.\nThe effectiveness of trajectory\nreuse\nis demonstrated via ablation studies in Section\nIV\n.\nFigure 6\n:\nIllustration of the strategy for maintaining consistency across two consecutive planning loops. (a) The A* algorithm is initialized from\np\nG\np_{G}\n, the\nG\nG\n-th state of the trajectory generated in the previous planning loop. (b) The line segment connecting the current state\np\nc\np_{c}\nand\np\nG\np_{G}\nis used as the seed for generating the SFC.\nIV\nExperiments and Analysis\nIV-A\nSimulation Experiments\nIV-A\n1\nExperimental Setup\nThe proposed approach is evaluated extensively through both simulation and real-world experiments.\nThe basic parameters\nare kept consistent in both simulation and real-world experiments, as shown in Table\nI\n.\nThe MPCC is deployed on acados\n[\n26\n]\n, using SQP-RTI for real-time computation, with the control loop running at 100 Hz. We use a horizon length of\nN\n=\n20\nN=20\nand a time step of\nd\nt\n=\n0.03\nd_{t}=0.03\ns.\nOnline replanning is performed at every control loop, both on a desktop computer with an Intel i9-13900HX CPU for simulation and on the Intel NUC 13 with an i7-1360P CPU for experiment.\nThe neural network is built and trained using the PyTorch framework and deployed using libtorch for real-time inference.\nTABLE I\n:\nParameters in simulation & real world\nParameters\nd\nâ€‹\ni\nâ€‹\na\nâ€‹\ng\nâ€‹\n(\nğ‰\n)\ndiag(\\mathbf{J})\n[gm\n2\n]\nm\nm\n[kg]\nl\nl\n[m]\nc\nÏ„\nc_{\\tau}\n[1]\n(\nd\nx\n,\nd\ny\n,\nd\nz\n)\n(d_{x},d_{y},d_{z})\n[\ns\nâˆ’\n1\n\\mathrm{s}^{-1}\n]\nValue\n[50,53,62]\n1.55\n0.1125\n0.02\n(0.3,0.3,0.5)\nParameters\nğ\nmax\n\\bm{\\omega}_{\\text{max}}\n[radÂ·s\n-1\n]\nN\nN\nG\nG\nÎ¼\n\\mu\nq\nc\nq_{c}\nValue\n[10,10,0.3]\n20\n10\n500\n30000\nWe benchmark LOONG against state-of-the-art planning frameworks for autonomous navigation. SUPER\n[\n21\n]\n, a high-speed polynomial navigation framework, is selected for its suitability for time-critical tasks, while IPC\n[\n11\n]\nis included as a representative low-latency integrated planning-control baseline.\nWe use two open-source simulation environments\nwith different obstacle densities\nthat focus on challenging flight in\ntime-critical task\n(Fig.\n7\n) or\ncluttered forest\n(Fig.\n8\n),\nand the LiDAR simulator provided by SUPER, which considers the limited field of view (FOV) and realistic point of LiDAR sensor\n[\n21\n]\n.\nIt should be noted that SUPERâ€™s simulator does not account for the MAVâ€™s dynamics, which assumes that SUPERâ€™s trajectories of\nğ’‘\n,\nğ’’\n,\nğ’—\n\\bm{p},\\bm{q},\\bm{v}\ncan be perfectly tracked.\nFor the other two integrated planning-control frameworks, IPC uses a simplified third-order integrator assuming MPC states of\nğ’‘\n,\nğ’—\n,\nğ’‚\n\\bm{p},\\bm{v},\\bm{a}\ncan be perfectly tracked\nwith jerk\nğ’‹\n\\bm{j}\ninput.\nIn contrast, ours incorporates an external integrator of full dynamics (\n7\n) with thrusts\nğ’‡\n\\bm{f}\nas inputs.\nIV-A\n2\nAblation Studies in Time-Critical Task Scenario\nWe first conduct an ablation study in the\ntime-critical task\nscenario based on the default configuration of LOONG to quantify how each component of our framework affects reliability and aggressiveness. Each configuration is evaluated over 10 trials with identical start and goal, and the success rate, average velocity, average maximum velocity, and average flight time are recorded in Table\nII\n, where averages are computed only over successful trials.\nThe default configuration includes all modules described\nabove\nwith a mass-normalized collective thrust limit of\nf\nm\nâ€‹\na\nâ€‹\nx\n=\n33\nâ€‹\nm/s\n2\nf_{max}=33\\text{m/s}^{2}\n,\nwhich\nis evenly allocated to four individual thrusts as dynamic constraints in (\n9\n).\nCompared to the default configuration, where\nG\n=\n10\nG=10\n,\ntrajectory reuse\nis enabled for replanning, and waypoints are selected by passing through the SFC intersections, we evaluate several variants by separately modifying these components, including configurations with\nG\n=\n1\nG=1\nand\nG\n=\n20\nG=20\n, disabling\ntrajectory reuse\n, and selecting waypoints without passing through the SFC intersections.\nThe results indicate that when\nG\n=\n1\nG=1\n, the insufficient real-time iterative solving undermines obstacle avoidance without improving flight speed. We conjecture that insufficient solver progress keeps the MPCC trajectory close to obstacles, thereby limiting the free space available for subsequent optimization.\nWhen\nG\n=\n20\nG=20\n, excessively strict and conservative constraints result in reduced aggressiveness and more solver failures.\nIn the absence of\ntrajectory reuse\n, the front-end A* may select kinetically infeasible or densely obstructed paths, which then lead to collisions or failures in the back-end MPCC.\nWithout passing the SFC intersection, the success rates drop substantially, since the waypoints are placed too close to obstacles, severely restricting perception range and the feasible solution space for trajectory optimization in high-speed flight.\nTABLE II\n:\nAblation studies in the time-critical task.\nConfiguration\nNumber of\nSuccess\nâ†‘\n\\uparrow\nAverage\nVelocity (m/s)\nâ†‘\n\\uparrow\nAverage\nMaximum\nVelocity (m/s)\nâ†‘\n\\uparrow\nAverage\nFlight\nTime (s)\nâ†“\n\\downarrow\nDefault (\nG\n=\n10\nG=10\n)\n10/10\n26.89\n42.77\n3.72\nG\n=\n1\nG=1\n6/10\n26.61\n40.46\n3.76\nG\n=\nN\n=\n20\nG=N=20\n5/10\n18.24\n29.76\n5.56\nw.o.\nTrajectory Reuse\n2/10\n26.92\n45.41\n3.71\nw.o. Passing SFC Intersection\n1/10\n24.65\n37.88\n4.05\nIV-A\n3\nBenchmark in Time-Critical Task Scenario\nTo exhibit the effectiveness and aggressiveness of the proposed method, we benchmark LOONG against SUPER and IPC in\ntime-critical task\nscenario encouraging aggressive maneuvering, as shown in Fig.\n7\n,\nwhere four configurations are evaluated in the comparison. We respect the default configurations of the baseline methods, including the default SUPER, originally designed for MAVs\nwith a thrust-to-weight ratio exceeding 5, and the default IPC.\nTo ensure a fair comparison under identical actuator constraints, we configure both SUPER and LOONG with the same maximum collective thrust,\nf\nmax\n=\n25\nâ€‹\nm/s\n2\nf_{\\max}=25\\,\\text{m/s}^{2}\n. For this comparison, all other dynamic constraints in SUPER, including velocity, acceleration, and jerk limits, are removed, while the maximum collective thrust in LOONG is reduced from its default configuration to match\nf\nmax\nf_{\\max}\n. In addition, the default SUPER configuration is retained as a reference baseline. All methods are evaluated over 10 repeated trials.\nFigure 7\n:\nOne trial of four methods with identical start and goal points. (a) Trajectories in\ntime-critical task\nsimulation. (b) Mass-normalized collective thrust and velocity profiles. Our method fully exploits the thrust limit while maintaining obstacle avoidance.\nThe upper part of Table\nIII\nrecords the success rates over repeated trials, computation time for planning and control, and etc.\nSince the obstacles in this scenario are relatively sparse, none of the methods experienced collisions or solver failures.\nOur method achieves greater aggressiveness in terms of average velocity, average maximum velocity, and average flight time compared to other approaches, while maintaining comparable safety.\nAs shown in Fig.\n7\n(b),\nSUPER slightly exceeds the limit\nf\nmax\n=\n25\nâ€‹\nm\n/\ns\n2\nf_{\\max}=25\\,\\mathrm{m/s}^{2}\n.\nWe conjecture that, under a general multi-objective optimization framework, soft constraints can be violated\n[\n28\n]\n.\nDespite occasionally violating the thrust limit, SUPER still exhibits longer flight times than our LOONG. We attribute the reduced aggressiveness of SUPER primarily to two factors. First, SUPER plans polynomial trajectories, whose inherent smoothness conflicts with time-optimal objectives\n[\n3\n]\n, fundamentally limiting achievable flight speed. Second, as SUPER prioritizes safety, it switches to conservative trajectories when high-speed replanning cannot be completed within the required time, which further reduces flight aggressiveness.\nIn contrast, our method can reach the input limits without violation, ensuring that dynamic constraints are satisfied even when the MAV is operating at actuator limits, while achieving a replanning frequency of 100â€‰Hz,\naligning with IPC in planning-control integration efficiency. Moreover, although IPC\nsupports high planning frequency, it is overly conservative due to its naive average time allocation,\nand is therefore excluded from subsequent benchmarks.\nTABLE III\n:\nComparison of different framework in Simulation.\nScenario\nPlanning Framework\nNumber of\nSuccess\nâ†‘\n\\uparrow\nAverage\nVelocity (m/s)\nâ†‘\n\\uparrow\nAverage\nMaximum\nVelocity (m/s)\nâ†‘\n\\uparrow\nAverage\nComputation\nTime (ms)\nâ†“\n\\downarrow\nAverage\nFlight\nTime (s)\nâ†“\n\\downarrow\ntime-critical task\n15\nâ€‹\nm\nÃ—\n120\nâ€‹\nm\nÃ—\n4\nâ€‹\nm\n15\\mathrm{m}\\times 120\\mathrm{m}\\times 4\\mathrm{m}\nSUPER - default\n10/10\n16.23\n24.88\n24.86\n6.24\nIPC - default\n10/10\n2.85\n3.19\n2.41\n40.57\nSUPER - w. only thrust limit\n10/10\n17.99\n29.91\n25.28\n5.62\nLOONG(Ours)\n10/10\n22.10\n33.15\n5.87\n4.64\ncluttered forest\n60\nâ€‹\nm\nÃ—\n60\nâ€‹\nm\nÃ—\n5\nâ€‹\nm\n60\\mathrm{m}\\times 60\\mathrm{m}\\times 5\\mathrm{m}\nSUPER -\nhigh-speed\n4/10\n7.34\n17.63\n47.98\n8.81\nLOONG(Ours) -\nhigh-speed\n6/10\n13.63\n20.60\n6.84\n4.56\nSUPER -\ndense\n10/10\n6.81\n8.00\n50.11\n9.53\nLOONG(Ours) -\ndense\n10/10\n6.94\n9.28\n6.43\n9.15\nFigure 8\n:\nTrajectories of four planning configurations starting from 10 different points in the\ncluttered forest\nscenario. Some\nhigh-speed\ntrials failed while all\ndense\ntrials succeeded. Ours achieved a more agile performance compared to SUPER.\nIV-A\n4\nBenchmark in Cluttered Forest\nTo evaluate the robustness of LOONG, we conduct experiments in the\ncluttered forest\nscenario and compare its performance with SUPER. For a fair comparison against SUPERâ€™s two open-source configurations\nhigh-speed\n(default) and\ndense\n, the velocity limit of LOONG,\nv\nÎ¸\n,\nm\nâ€‹\na\nâ€‹\nx\n{v}_{\\theta,max}\n, is reduced from\nits default configuration to 25â€‰m/s or 8â€‰m/s, respectively, to match SUPERâ€™s maximum speeds\nğ’—\n\\bm{v}\n.\nFor each configuration, 10 trials are conducted with different start and goal points.\nThe experimental results are summarized in the lower part of Table III and Fig.\n8\n.\nTable\nIII\nindicates that for\nhigh-speed\nconfiguration, LOONG achieves faster flights and higher success rates by leveraging actuators more sufficiently and maintaining a higher replanning frequency.\nFor\ndense\nconfiguration, LOONG finishes all flights\nwhile demonstrating superior agility and computational efficiency.\nNotably,\ncompared to Section\nIV-A\n3\n,\nwhile SUPER manages\ntime-critical task\nby\nhigh-speed\nconfiguration and\ncluttered forest\nby\ndense\nconfiguration, it necessitates extensive parameter tuning, such as planning horizon, penalty weights, resolution,\netc., whereas LOONG requires only one parameter\nv\nÎ¸\n,\nm\nâ€‹\na\nâ€‹\nx\n{v}_{\\theta,max}\nadjustment.\nMoreover,\ndue to relatively stable MPCC complexity and consistent neural network inference time, LOONGâ€™s computation time is largely insensitive to environmental complexity, 5.87â€‰ms and 6.43â€‰ms respectively,\nwhereas SUPERâ€™s computation time nearly doubles from 24.86â€‰ms in\ntime-critical task\nto 50.11â€‰ms in\ncluttered forest\n.\nIV-B\nReal-world Experiments\nIV-B\n1\nReal-world Experiment Setup\nWe validate the systemâ€™s effectiveness\nand reliability through real-world experiments.\nThe experiments can be found in the [\nvideo\n].\nFor the hardware platform, we deploy a custom-built compact MAV with a 225â€‰mm wheelbase,\nas shown in Fig.\n9\n.\nThe fully loaded\nvehicle\nweighs 1.5â€‰kg and delivers a thrust-to-weight ratio exceeding 5.0. It is actuated by T-Motor F80PRO motors, which are typically used in racing drone,\nproviding high thrust (up to 21.1 N with 5-inch propellers) and rapid response.\nThe onboard computation is performed by an Intel NUC 13 computer featuring a 12-core 5.0â€‰GHz CPU, and a flight control unit (FCU) running Betaflight with custom firmware. For perception, the MAV is equipped with a MID-360 3D LiDAR sensor.\nFAST-LIO2\n[\n29\n]\nis used\nto fuse data from the LiDAR and IMU sensors, while a sliding point-cloud map\n[\n21\n]\nis used to represent the occupied spaces of the environment.\nFor planning and control, the default configuration of LOONG is used.\nFigure 9\n:\nHardware platform of LOONG.\nIV-B\n2\nHigh-Speed Autonomous Flights in Clutter\nFigure 10\n:\nReal-world trajectories visualization for repeated high-speed flights,\ndemonstrating the reproducible aggressive behavior.\nTo test the systematic effectiveness and aggressiveness of the proposed method,\nwe first have our MAV perform an aggressive flight in a 20â€‰m indoor scenario with obstacles.\nAs shown in Fig.\n1\n,\nthe MAV begins at a hover height of\n1.5\nâ€‹\nm\n1.5\\,\\text{m}\nat\nt\n=\n0\nâ€‹\ns\nt=0\\,\\text{s}\nand traverses a\n10\nâ€‹\nm\nÃ—\n10\nâ€‹\nm\n10\\,\\text{m}\\times 10\\,\\text{m}\ncluttered region to reach the goal.\nThe obstacle field has a density of 0.30 obstacles\n/\nm\n2\n/\\mathrm{m}^{2}\n, with obstacle heights in the range\n[\n0.8\nâ€‹\nm\n,\n3.0\nâ€‹\nm\n]\n[0.8\\,\\mathrm{m},3.0\\,\\mathrm{m}]\nand obstacle radii in the range\n[\n0.2\nâ€‹\nm\n,\n0.6\nâ€‹\nm\n]\n[0.2\\,\\mathrm{m},0.6\\,\\mathrm{m}]\n.\nThe maximum gap between adjacent obstacles is about 2.5â€‰m.\nAs shown in Fig.\n1\n(b), the velocity profile indicates that the MAV reaches 18â€‰m/s in about 1.2â€‰s, while the throttle profile normalized by the collective thrust limit shows that the system can operate at its maximum thrust, enabling agile maneuvering among obstacles during the real-time autonomous flight.\nThree additional experiments are conducted to evaluate the robustness of the proposed system, as shown in Fig. 10.\nIV-B\n3\nConsecutive Trials with Random Start Points\nAs shown in Fig.\n11\n, the MAV adaptively maneuvered through free space between obstacles in ten consecutive trials of 18â€‰m forward flight, demonstrating the real-world generalization and reliability of our system with the default LOONG configuration.\nThe MAV traversed from three directions, with initial positions randomly selected within a 2â€‰m radius and initial yaw angles within\nÂ±\n10\nâˆ˜\n\\pm 10^{\\circ}\n.\nFig.\n12\npresents the onboard computation time of each planning component per loop.\nIt can be observed that the proposed path planning and reference generation methods require approximately 0.5â€‰ms and 0.3â€‰ms per loop, respectively, demonstrating high computational efficiency. By significantly reducing the computational burden of the front-end modules, sufficient onboard computational resources are reserved for the more time-consuming MPCC, thereby enabling the MAV to achieve online planning at a frequency of 100 Hz.\nDespite traversing highly cluttered obstacles, all ten consecutive flights succeed, as depicted in Fig.\n12\n(b), and achieved an average peak speed of 14.72 m/s and an average flight time of 2.29 s, as illustrated in Fig.\n12\n(c).\nThese results strongly demonstrate our frameworkâ€™s capability to autonomously generate safe and agile trajectories in challenging environments in real time.\nFigure 11\n:\nReal-world trajectories from ten consecutive trials with random start points. Snapshots in the composite trajectory plot are taken at 0.033â€‰s intervals.\nThe MAV autonomously performs various obstacle avoidance behaviors:\n(a)-(c) bypassing obstacles at high speed from different sides,\n(d)-(f) gaining altitude to avoid densely cluttered regions,\n(g) aggressive avoidance maneuvers in response to close obstacles,\n(h) rapid traversal through a narrow gap,\n(i) large pitch maneuver for acceleration,\n(j) nimble attitude changes.\nFigure 12\n:\nReal-world consecutive trial data of LOONG. (a) Onboard computation time distribution per step, with total time below 10â€‰ms to achieve 100â€‰Hz replanning. (b) Visualization of ten trajectories.\n(c) Statistics of flight time and velocity.\nV\nConclusion and Discussion\nThis article presents a learning-accelerated online time-optimal planning and control framework termed LOONG for MAVsâ€™ high-speed autonomous flight,\nwhich exhibits both aggressive flight performance and safety in simulation and real-world experiments.\nSeveral improvements are envisioned for future work.\nFor the optimization scheme, while the current RTI solver enables real-time performance, its convergence may be challenged in extremely dynamic environments.\nThe recent advancement of onboard GPUs and the sampling-based scheme of model predictive path integral\n(MPPI)\ncould overcome this bottleneck by enabling massive parallel roll-outs in real time.\nMoreover, our benchmark demonstrates LOONGâ€™s\ngeneralization\nby merely adjusting the maximum progress speed. Thereby, environment-adaptive tuning remains a promising enhancement.\nFinally, given LOONGâ€™s fully autonomous design and generalization, expanding its application to outdoor and field environments offers an exciting frontier for achieving even greater performance.\nReferences\n[1]\nS. M. S. M. Daud, M. Y. P. M. Yusof, C. C. Heo, L. S. Khoo, M. K. C. Singh, M. S. Mahmood, and H. Nawawi\n(2022)\nApplications of drone in disaster management: a scoping review\n.\nScience & Justice\n62\n(\n1\n),\npp.Â 30â€“42\n.\nCited by:\nÂ§I\n.\n[2]\nM. Faessler, A. Franchi, and D. Scaramuzza\n(2017)\nDifferential flatness of quadrotor dynamics subject to rotor drag for accurate tracking of high-speed trajectories\n.\nIEEE Robotics and Automation Letters\n3\n(\n2\n),\npp.Â 620â€“626\n.\nCited by:\nÂ§I\n,\nÂ§\nII-B\n,\nÂ§\nIII-A\n.\n[3]\nP. Foehn, A. Romero, and D. Scaramuzza\n(2021)\nTime-optimal planning for quadrotor waypoint flight\n.\nScience Robotics\n6\n(\n56\n),\npp.Â eabh1221\n.\nCited by:\nÂ§I\n,\nÂ§\nII-C\n,\nÂ§\nIV-A\n3\n.\n[4]\nX. Guan, F. Zhao, S. Tian, and S. Li\n(2025)\nLearning time-optimal online replanning for distributed model predictive contouring control of quadrotors\n.\nIn\n2025 IEEE International Conference on Robotics and Automation (ICRA)\n,\npp.Â 14527â€“14533\n.\nCited by:\nÂ§I\n,\nÂ§\nII-C\n,\nÂ§\nIII-B\n.\n[5]\nD. Hanover, A. Loquercio, L. Bauersfeld, A. Romero, R. Penicka, Y. Song, G. Cioffi, E. Kaufmann, and D. Scaramuzza\n(2024)\nAutonomous drone racing: a survey\n.\nIEEE Transactions on Robotics\n.\nCited by:\nÂ§I\n.\n[6]\nE. Kaufmann, L. Bauersfeld, A. Loquercio, M. MÃ¼ller, V. Koltun, and D. Scaramuzza\n(2023)\nChampion-level drone racing using deep reinforcement learning\n.\nNature\n620\n(\n7976\n),\npp.Â 982â€“987\n.\nCited by:\nÂ§I\n.\n[7]\nJ. Kohler, M. A. Muller, and F. Allgower\n(2024)\nAnalysis and design of model predictive control frameworks for dynamic operation-an overview\n.\nAnnual Reviews in Control\n57\n,\npp.Â 100929\n.\nExternal Links:\nISSN 1367-5788\n,\nDocument\nCited by:\nÂ§\nIII-B\n.\n[8]\nR. Li and B. Xin\n(2025)\nAutonomous navigation of quadrotors in dynamic complex environments\n.\nIEEE Transactions on Industrial Electronics\n72\n(\n3\n),\npp.Â 2790â€“2800\n.\nExternal Links:\nDocument\nCited by:\nÂ§I\n.\n[9]\nK. Liu and B. M. Chen\n(2023)\nIndustrial uav-based unsupervised domain adaptive crack recognitions: from database towards real-site infrastructural inspections\n.\nIEEE Transactions on Industrial Electronics\n70\n(\n9\n),\npp.Â 9410â€“9420\n.\nExternal Links:\nDocument\nCited by:\nÂ§I\n.\n[10]\nS. Liu, M. Watterson, K. Mohta, K. Sun, S. Bhattacharya, C. J. Taylor, and V. Kumar\n(2017)\nPlanning dynamically feasible trajectories for quadrotors using safe flight corridors in 3-d complex environments\n.\nIEEE Robotics and Automation Letters\n2\n(\n3\n),\npp.Â 1688â€“1695\n.\nCited by:\nÂ§I\n.\n[11]\nW. Liu, Y. Ren, and F. Zhang\n(2023)\nIntegrated planning and control for quadrotor navigation in presence of suddenly appearing objects and disturbances\n.\nIEEE Robotics and Automation Letters\n9\n(\n1\n),\npp.Â 899â€“906\n.\nCited by:\nÂ§I\n,\nÂ§\nIV-A\n1\n.\n[12]\nA. Loquercio, E. Kaufmann, R. Ranftl, M. MÃ¼ller, V. Koltun, and D. Scaramuzza\n(2021)\nLearning high-speed flight in the wild\n.\nScience Robotics\n6\n(\n59\n),\npp.Â eabg5810\n.\nCited by:\nÂ§I\n.\n[13]\nG. Lu, W. Xu, and F. Zhang\n(2023)\nOn-manifold model predictive control for trajectory tracking on robotic systems\n.\nIEEE Transactions on Industrial Electronics\n70\n(\n9\n),\npp.Â 9192â€“9202\n.\nExternal Links:\nDocument\nCited by:\nÂ§I\n.\n[14]\nD. Mellinger and V. Kumar\n(2011)\nMinimum snap trajectory generation and control for quadrotors\n.\nIn\n2011 IEEE International Conference on Robotics and Automation\n,\npp.Â 2520â€“2525\n.\nCited by:\nÂ§I\n,\nÂ§\nII-B\n.\n[15]\nB. Mishra, D. Garg, P. Narang, and V. Mishra\n(2020)\nDrone-surveillance for search and rescue in natural disaster\n.\nComputer Communications\n156\n,\npp.Â 1â€“10\n.\nCited by:\nÂ§I\n.\n[16]\nK. Mohta, M. Watterson, Y. Mulgaonkar, S. Liu, C. Qu, A. Makineni, K. Saulnier, K. Sun, A. Zhu, J. Delmerico,\net al.\n(2018)\nFast, autonomous flight in gps-denied and cluttered environments\n.\nJournal of Field Robotics\n35\n(\n1\n),\npp.Â 101â€“120\n.\nCited by:\nÂ§I\n.\n[17]\nH. Moon, J. Martinez-Carranza, T. Cieslewski, M. Faessler, D. Falanga, A. Simovic, D. Scaramuzza, S. Li, M. Ozo, C. De Wagter,\net al.\n(2019)\nChallenges and implemented technologies used in autonomous drone racing\n.\nIntelligent Service Robotics\n,\npp.Â 1â€“12\n.\nCited by:\nÂ§I\n.\n[18]\nH. Oleynikova, M. Burri, Z. Taylor, J. Nieto, R. Siegwart, and E. Galceran\n(2016)\nContinuous-time trajectory optimization for online uav replanning\n.\nIn\n2016 IEEE/RSJ international conference on intelligent robots and systems (IROS)\n,\npp.Â 5332â€“5339\n.\nCited by:\nÂ§I\n.\n[19]\nH. Oleynikova, Z. Taylor, M. Fehr, R. Siegwart, and J. Nieto\n(2017)\nVoxblox: incremental 3d euclidean signed distance fields for on-board mav planning\n.\nIn\n2017 IEEE/RSJ International Conference on Intelligent Robots and Systems (IROS)\n,\npp.Â 1366â€“1373\n.\nCited by:\nÂ§I\n.\n[20]\nY. Ren, F. Zhu, W. Liu, Z. Wang, Y. Lin, F. Gao, and F. Zhang\n(2022)\nBubble planner: planning high-speed smooth quadrotor trajectories using receding corridors\n.\nIn\n2022 IEEE/RSJ International Conference on Intelligent Robots and Systems (IROS)\n,\npp.Â 6332â€“6339\n.\nCited by:\nÂ§I\n.\n[21]\nY. Ren, F. Zhu, G. Lu, Y. Cai, L. Yin, F. Kong, J. Lin, N. Chen, and F. Zhang\n(2025)\nSafety-assured high-speed navigation for mavs\n.\nScience Robotics\n10\n(\n98\n),\npp.Â eado6187\n.\nCited by:\nÂ§I\n,\nÂ§I\n,\nÂ§\nII-A\n,\nÂ§\nII-A\n,\nÂ§\nIII-B\n,\nÂ§\nIV-A\n1\n,\nÂ§\nIV-B\n1\n.\n[22]\nC. Richter, A. Bry, and N. Roy\n(2016)\nPolynomial trajectory planning for aggressive quadrotor flight in dense indoor environments\n.\nIn\nRobotics Research: The 16th International Symposium ISRR\n,\npp.Â 649â€“666\n.\nCited by:\nÂ§I\n.\n[23]\nA. Romero, R. Penicka, and D. Scaramuzza\n(2022)\nTime-optimal online replanning for agile quadrotor flight\n.\nIEEE Robotics and Automation Letters\n7\n(\n3\n),\npp.Â 7730â€“7737\n.\nCited by:\nÂ§I\n.\n[24]\nA. Romero, S. Sun, P. Foehn, and D. Scaramuzza\n(2022)\nModel predictive contouring control for time-optimal quadrotor flight\n.\nIEEE Transactions on Robotics\n38\n(\n6\n),\npp.Â 3340â€“3356\n.\nCited by:\nÂ§I\n,\nÂ§\nIII-B\n,\nÂ§\nIII-B\n.\n[25]\nY. Song, A. Romero, M. MÃ¼ller, V. Koltun, and D. Scaramuzza\n(2023)\nReaching the limit in autonomous racing: optimal control versus reinforcement learning\n.\nScience Robotics\n8\n(\n82\n),\npp.Â eadg1462\n.\nCited by:\nÂ§I\n.\n[26]\nR. Verschueren, G. Frison, D. Kouzoupis, J. Frey, N. v. Duijkeren, A. Zanelli, B. Novoselnik, T. Albin, R. Quirynen, and M. Diehl\n(2022)\nAcados-a modular open-source framework for fast embedded optimal control\n.\nMathematical Programming Computation\n14\n(\n1\n),\npp.Â 147â€“183\n.\nCited by:\nÂ§\nIII-B\n,\nÂ§\nIV-A\n1\n.\n[27]\nQ. Wang, Z. Wang, M. Wang, J. Ji, Z. Han, T. Wu, R. Jin, Y. Gao, C. Xu, and F. Gao\n(2025)\nFast iterative region inflation for computing large 2-d/3-d convex regions of obstacle-free space\n.\nIEEE Transactions on Robotics\n.\nCited by:\nÂ§I\n,\nÂ§\nII-A\n.\n[28]\nZ. Wang, X. Zhou, C. Xu, and F. Gao\n(2022)\nGeometrically constrained trajectory optimization for multicopters\n.\nIEEE Transactions on Robotics\n38\n(\n5\n),\npp.Â 3259â€“3278\n.\nCited by:\nÂ§I\n,\nÂ§\nII-B\n,\nÂ§\nII-C\n,\nÂ§\nIV-A\n3\n.\n[29]\nW. Xu, Y. Cai, D. He, J. Lin, and F. Zhang\n(2022)\nFAST-lio2: fast direct lidar-inertial odometry\n.\nIEEE Transactions on Robotics\n38\n(\n4\n),\npp.Â 2053â€“2073\n.\nExternal Links:\nDocument\nCited by:\nÂ§\nIV-B\n1\n.\n[30]\nJ. Yuan, D. Cao, J. Mei, J. Chen, and S. Li\n(2025)\nSafety-critical online quadrotor trajectory planner for agile flights in unknown environments\n.\nIn\n2025 IEEE International Conference on Robotics and Automation (ICRA)\n,\npp.Â 11773â€“11779\n.\nCited by:\nÂ§I\n,\nÂ§I\n.\n[31]\nY. Zhang, Y. Hu, Y. Song, D. Zou, and W. Lin\n(2024)\nBack to newtonâ€™s laws: learning vision-based agile flight via differentiable physics\n.\narXiv preprint arXiv:2407.10648\n.\nCited by:\nÂ§I\n.\n[32]\nB. Zhou, F. Gao, L. Wang, C. Liu, and S. Shen\n(2019)\nRobust and efficient quadrotor trajectory generation for fast autonomous flight\n.\nIEEE Robotics and Automation Letters\n4\n(\n4\n),\npp.Â 3529â€“3536\n.\nCited by:\nÂ§I\n.\n[33]\nX. Zhou, X. Wen, Z. Wang, Y. Gao, H. Li, Q. Wang, T. Yang, H. Lu, Y. Cao, C. Xu,\net al.\n(2022)\nSwarm of micro flying robots in the wild\n.\nScience Robotics\n7\n(\n66\n),\npp.Â eabm5954\n.\nCited by:\nÂ§I\n,\nÂ§I\n.\n[34]\nY. Zhou, S. Lai, H. Cheng, A. H. M. Redhwan, P. Wang, J. Zhu, Z. Gao, Z. Ma, Y. Bi, F. Lin, and B. M. Chen\n(2021)\nToward autonomy of micro aerial vehicles in unknown and global positioning system denied environments\n.\nIEEE Transactions on Industrial Electronics\n68\n(\n8\n),\npp.Â 7642â€“7651\n.\nExternal Links:\nDocument\nCited by:\nÂ§I\n.",
    "preview_text": "Autonomous flight of micro air vehicles (MAVs) in unknown, cluttered environments remains challenging for time-critical missions due to conservative maneuvering strategies. This article presents an integrated planning and control framework for high-speed, time-optimal autonomous flight of MAVs in cluttered environments. In each replanning cycle (100 Hz), a time-optimal trajectory under polynomial presentation is generated as a reference, with the time-allocation process accelerated by imitation learning. Subsequently, a time-optimal model predictive contouring control (MPCC) incorporates safe flight corridor (SFC) constraints at variable horizon steps to enable aggressive yet safe maneuvering, while fully exploiting the MAV's dynamics. We validate the proposed framework extensively on a custom-built LiDAR-based MAV platform. Simulation results demonstrate superior aggressiveness compared to the state of the art, while real-world experiments achieve a peak speed of 18 m/s in a cluttered environment and succeed in 10 consecutive trials from diverse start points. The video is available at the following link: https://youtu.be/vexXXhv99oQ.\n\nLOONG: Online Time-Optimal Autonomous Flight for MAVs in Cluttered Environments\nXin Guan, Fangguo Zhao,\nQianyi Wang,\nChengcheng Zhao,\nJiming Chen,\nFellow, IEEE\n,\nand Shuo Li,\nThe authors are with the College of Control Science and Engineering, Zhejiang University, Hangzhou 310027, China (e-mail: shuo.li@zju.edu.cn)\n(Corresponding author: Shuo Li.)\n.\nAbstract\nAutonomous flight of micro air vehicles (MAVs) in unknown, cluttered environments remains challenging for time-critical missions due to conservative maneuvering strategies. This article presents an integrated planning and control framework for high-speed, time-optimal autonomous flight of MAVs in cluttered environments. In each replanning cycle (100â€‰Hz), a time-optimal trajectory under polynomial presentation is generated as a reference, with the time-allocation process accelerate",
    "is_relevant": true,
    "relevance_score": 3.0,
    "extracted_keywords": [
        "locomotion",
        "whole body control"
    ],
    "one_line_summary": "è¯¥è®ºæ–‡æå‡ºäº†ä¸€ç§ç”¨äºå¾®å‹é£è¡Œå™¨åœ¨æ‚ä¹±ç¯å¢ƒä¸­é«˜é€Ÿã€æ—¶é—´æœ€ä¼˜è‡ªä¸»é£è¡Œçš„é›†æˆè§„åˆ’ä¸æ§åˆ¶æ¡†æ¶ï¼Œä¸»è¦æ¶‰åŠè¿åŠ¨æ§åˆ¶å’Œæ•´ä½“æ§åˆ¶æŠ€æœ¯ã€‚",
    "detailed_summary": "",
    "qa_pairs": [],
    "is_hidden": false,
    "is_starred": false,
    "flag": true,
    "published_date": "2026-01-12T11:24:54Z",
    "created_at": "2026-01-21T12:09:09.786532",
    "updated_at": "2026-01-21T12:09:09.786540",
    "recommend": 0
}